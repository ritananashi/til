※スクール内timesの移植（2025/09/16）


よしよし…
[![Image from Gyazo](https://i.gyazo.com/8c8ae9c295cde12c4bd66ea325be2743.png)](https://gyazo.com/8c8ae9c295cde12c4bd66ea325be2743)

デフォルトで入力欄一個表示させるのはできたので後はオリジナルインクが選択されたときだけ入力欄を表示…。

imputイベントで判定すればよいと思うのでやる

あーinputイベントだとキーボード入力じゃないと発火しないや。インク選択画面から選択してフォームに反映させたときは別なアクションじゃないとだめか。

インク選んだ時に一緒にchangeイベントを強制発火させる？ふーん…

Stimulusのdispatch関数が全然わからん

dispatch関数はCustomEventのみなんすか？

じゃあ普通に強制発火か…

:v: 
[![Image from Gyazo](https://i.gyazo.com/e0e0dc47c5ed4caba8afe39f600f73f0.gif)](https://gyazo.com/e0e0dc47c5ed4caba8afe39f600f73f0)
[![Image from Gyazo](https://i.gyazo.com/6ea9f217e5c38f796910a92c97603b20.gif)](https://gyazo.com/6ea9f217e5c38f796910a92c97603b20)


- 学習時間：5h30min/7h30min/912h30min
- 学習内容：卒制
  

しんどくなったらすぐ休もう～と思ってやってたらけっこう作業できました。

Rails-Nested-formのビューファイル部分の続きやってました。

デザインは結局全部横並びでも、開発者モードで確認できる一番小さいスマホ画面で支障なさそうだったので、横並びでいけるようにフォームのサイズ調整しました。

あと、Rails-Nested-formはデフォルトでは入力欄を出してくれないので、[公式のこのissue](https://github.com/stimulus-components/stimulus-components/issues/62)を参考にやったら、デフォルトで一個の入力欄を表示できました。

そのあとは、オリジナルインクが選択されたときだけインクレシピ入力欄を表示させたかったので、これやってました。

入力欄を隠すの事態は、classにhiddenを設定すればいいだけなので、あとはhiddenをどうやって消すか、です。

stimulusは入力フォームはデフォルトでinputアクションが発火するようになっているので、とりあえずインク名入力欄に前方一致でオリジナルと入力されたらhiddenを除去するようにしました。

しかし、inputアクションはキーボード入力があるときに発火するので、インク選択画面からインク名入力欄にインクを反映させるとinputイベントは発火しません。

なので、今度はchangeイベントでやってみました。が、これもインク選択画面からインク名入力欄にインクを反映させるのではイベント発火しませんでした。

困ってGPTに他に入力を検知して発火するイベントがあるかどうか聞いてみましたが、インク選択したときのStimulusのメソッドにchangeイベントを強制的に発火させるコードを仕込む仕込むしかないかもみたいに言われました。ほんまか？

JSでイベントを発火させるときはdispatchEventというのを使うのですが、Stimulusにはdispatchというメソッドがあり、どうもこれでイベントを発火できる…ようだったのですが、カスタムイベントしかダメっぽいです。ここらへん公式のドキュメントわかりにくくて時間使っちゃった。

というわけで、dispatchEvent使ってchangeイベントを強制的に発火させて、ようやくインクレシピ入力欄の表示/非表示ができました。
[![Image from Gyazo](https://i.gyazo.com/e0e0dc47c5ed4caba8afe39f600f73f0.gif)](https://gyazo.com/e0e0dc47c5ed4caba8afe39f600f73f0)
[![Image from Gyazo](https://i.gyazo.com/6ea9f217e5c38f796910a92c97603b20.gif)](https://gyazo.com/6ea9f217e5c38f796910a92c97603b20)

明日はフォローフォロワー機能つくります。

本リリスケジュール遅れすぎてて就活に時間が割けない…。

