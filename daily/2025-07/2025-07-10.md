※スクール内timesの移植（2025/09/28）

これがアリならアリかなあ…商品じゃないけど…  
https://webservice.faq.rakuten.net/hc/ja/articles/900001970786-%E4%BB%96%E7%A4%BE%E3%81%AE%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%A7%E5%8F%96%E5%BE%97%E3%81%97%E3%81%9F%E5%95%86%E5%93%81%E3%82%92%E4%BD%B5%E7%BD%AE%E3%81%95%E3%81%9B%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AF%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%97%E3%82%87%E3%81%86%E3%81%8B  

とりあえずいいね順ソート→楽天API導入→カタログ作成くらいの順番と粒度でやってくか  
なんかransackのアドバンスモードでやってるからsort_linkでうまいこといかなくてどうしよ～～～ってしながら[猫Rails](https://nekorails.hatenablog.com/entry/2017/05/31/173925#%E7%AC%AC3%E7%AB%A0-%E3%82%A2%E3%83%89%E3%83%90%E3%83%B3%E3%82%B9%E3%83%88%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%E6%A4%9C%E7%B4%A2%E3%81%99%E3%82%8B)何回も読んだりGPTと壁打ちしてたらできそうな気がしてきた  
```
search
┣sorts
┗base(rootのgrouping)
　┣groupings(入れ子にできる)　　
　┣combinator
　┗conditions
　　　┣attributes
　　　┣values
　　　┗predicate
```
アドバンスモードがこんな感じの構造になってて今groupingsとcombinatorを指定しているから、このトップレベルのsortsに値を送れるようなリンクを作ればいいんじゃね？ってしてるところ  
sortsに値を渡してもダメって…コト！？  
ん～アドバンストモードよくわからん…

- 学習時間：5h30min/16h30min/1076h
- 学習内容：いいね順ソート実装

楽天APIの利用について、とりあえず自分の考える使い方ができそうだと思ったので、使うことにしました。  
カタログ化については、いいね順ソート→楽天API導入→カタログ作成の順番でやっていきます。  
というわけで、ransackをつかったいいね順ソートを実装しよう！ともちゃもちゃやってました。  

自分はransackのアドバンストモードで検索を実装しているのですが、ransackのソート機能を実装できる`sort_link`ヘルパーを使用してソートしようとしても…なんかうまくいかない…。  
`ハッシュの許可でてないよ`とかソートしたら検索結果が全部消えたりなどしています。どうして。  
アドバンストモードは
```
	
search
┣sorts
┗base(rootのgrouping)
　┣groupings(入れ子にできる)　　
　┣combinator
　┗conditions
　　　┣attributes
　　　┣values
　　　┗predicate
```
こういう構造になっているようなので、`sorts`に値を渡せば…と思いましたが、これもうまくいかず…。  
GPTがいうには、`ransackはparams[:q][:s]の形じゃないとソート条件を受け入れないよ！`らしいのですが、`params[:q][:s]`の形で受け取ろうとしてもうまくいかず…。  
アドバンストモードむずかしいね…。でもAND検索がこの実装じゃないと`それをAND検索っていうなよ`みたいな実装になっちゃうからさ…。  
もうちょっと考えたり調べたりしてみます。猫Rails何周もしたけどアドバンストモードむずかしいね。  

