※スクール内timesの移植（2025/11/26）

こんな感じになりました  
[![Image from Gyazo](https://i.gyazo.com/e541bbec9536113045c4a687721d5207.gif)](https://gyazo.com/e541bbec9536113045c4a687721d5207)  

Copilotのレビューで出た疑問点をGPTに聞く  

昨日の続き。  
画像処理ロジックをconcernsに切り出した。  
Copilotちゃんからちゃんとエラーハンドリングしなさいっておこられた。すみません…。  
このエラーハンドリングについて、Copilotちゃんは配列内の画像をmapで処理してエラーになったらnilに置き換えるみたいなコードを提案してきたんだけど、  
```
  images.map do |image|
    begin
      # 画像変換処理
    rescue => e
      Rails.logger.error("画像処理エラー: #{e.message}")
      nil
    end
  end.compact
```
という感じで`end.compact`となんだか見慣れない書き方をしていたのでGPTに聞いてみた。  
`compact`は配列内の`nil`を削除して返すメソッドで、この書き方をすると`mapの戻り値に対してcompactを実行する`ということになる。  
可読性良くないのであまり一般的ではない書き方みたい。  
`nil`を戻り値から削除したいなら`filter_map`を使うといいよって教えてもらった。  
`filter_map`は処理した結果から`nil`を削除してくれるメソッド　→　https://docs.ruby-lang.org/ja/latest/method/Enumerable/i/filter_map.html  
最初処理前にnilを消して処理するのかと思ったけど、処理後にnilを消してくれるようなのでこっちにした。  
というわけで画像投稿を置換から追加に変更しました。ずっとやりたかったことができて良かったです。  
次はダイレクトアップロードやります。まず導入からよぐわがんにゃいになってる。どうして…。  
npmでActiveStorageインストールする必要があるの？？？入ってないの？？？よぐわがんにゃい…。  
日祝休みなので（？）2連休します。  

