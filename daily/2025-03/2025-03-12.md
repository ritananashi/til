
📖[プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで](https://gihyo.jp/book/2021/978-4-297-12437-3)

#### 例外処理のペストプラクティス（つづき）

- 例外処理の対象範囲と対象クラスを極力絞り込む  
  例外処理を書くときは、例外が発生しそうな個所と発生しそうな例外クラスをあらかじめ予測し、その予測を例外処理のコードに反映させる。  
  例外処理の範囲が広すぎたり、補足する例外クラスの種類が多すぎると本来は異常終了扱いにすべき例外まで続行可能な例外として扱われてしまう。  

- 例外処理よりも条件分岐を使う  
  例外の発生がある程度予測できる処理なら、実際に実行する前に問題の有無を確認できる場合があるので、そういったときは条件分岐を使った方が可読性やパフォーマンスの面で有利。  
  例外処理を書く前に公式リファレンスで問題の有無を事前に確認できるメソッドが用意されてないかをチェックする。  

- 予期しない条件は異常終了させる  
  条件分岐を作るときは、どんなパターンがやってくるか事前にわかっていることが多いので、想定可能なパターンをすべて網羅し、else節では想定外のパターンとして例外を発生させることを検討する。  
  例外が発生するとプログラムの実行はそこで止まってしまうが、エラーメッセージやバックトレースがのこるので　、原因の調査と対策がしやすくなる。  
  微妙におかしい状態を保ったままプログラムが実行され続けると、いつ爆発するかわからない時限爆弾のような不具合を抱えることになるので、できるだけ早い段階で例外を発生させてプログラムを緊急停止させた方が、良い不具合であると言える。  

- 例外処理も手を抜かずにテストする  
  例外処理は例外的な状況でした呼び出されないため、テストしづらいケースも多いが、思わぬ不具合が隠れていたりするので、テストをおざなりにせずにしっかり行う必要がある。  
  例外処理をテスト死体が例外を発生させるのが難しい場合は、一時的にコードを書き換えてわざと例外を発生させるのもあり。  
  テストを自動化している時は、テスティングフレームワークの公式リファレンス等を参考にする。  

キリがいいのでここまで。次回ハンズオンから。