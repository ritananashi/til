
📖プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで

#### 配列についてもっと詳しく

- さまざまな要素の取得方法
  添え字を二つ使うと、添え字の位置と取得する長さを指定できる。配列で返ってくる。
  `配列[位置, 取得する長さ]`
  `values_at`メソッドで取得したい要素の添え字を複数指定できる。配列で返ってくる。
  配列の長さ - 1 で最後の要素を取得できる。`配列[配列.size - 1]`
  Rubyは添え字に負の数が使えるので、-1で最後の要素を指定できる。`配列[-1]`
  さらに、`last`メソッドを使うと配列の最後の要素を取得できる。反対のメソッドは`first`

- さまざまな要素の変更方法
  値を変更する場合も負の添え字が使えるが、元の大きさを超えるような添え字を指定するとエラーになる。
  開始位置と長さを指定して要素を置き換えられる。
  ```ruby
  a = [1, 2, 3, 4, 5]
  a[1, 3] = 100
  a #=> [1, 100, 5]
  ```
  `push`メソッドでも要素を追加できる。`<<`ではなく`push`メソッドを使うと、複数の値を追加できる。
  `delete`で指定した値に一致する要素を削除。

- 配列の連結
  複数の配列を連結するときは、`concat`メソッドか、`+`演算子を使う。
  `concat`メソッドを使うと、メソッドを呼び出した側の配列が変更される。
  `+`で連結すると、元の配列は変更せずに、新しい配列を作成する。
  `concat`は破壊的な変更をするメソッドなので、なるべく`+`演算子を使う方がいい。

- 配列の和集合、差集合、積集合
  `|`、`-`、`&`を使って、和集合、差集合、積集合を求めることができる。
  `|`は和集合を集める演算子。2つの配列の要素をすべて集め、重複しないようにして返す。
  ```ruby
  a = [1, 2, 3]
  b = [3, 4, 5]
  a | b #=> [1, 2, 3, 4, 5]
  ```
  `-`は差集合を求める演算子。左の配列から右の配列に含まれる要素を取り除く。
  ```ruby
  a = [1, 2, 3]
  b = [3, 4, 5]
  a - b #=> [1, 2]
  ```
  `&`は積集合を求める演算子。2つのは家rつに共通する要素を返す。
  ```ruby
  a = [1, 2, 3]
  b = [3, 4, 5]
  a & b #=> [3]
  ```
  いずれも元の配列は変更しない。
  配列よりも効率的に集合を扱えるSetクラスもあるので、本格的な集合演算をするときはSetクラスを使った方がいい。
  
- 多重代入で残りの全要素を配列として受け取る、または無視する
  多重代入では、変数よりも代入する要素の個数が多いときは、はみ出した値が切り捨てられるが、左辺の変数に`*`を付けると、残りの全要素を配列として受け取ることができる。
  ```ruby
  e, *f = 1, 2, 3
  e #=> 1
  f #=> [2, 3]
  ```
  逆に、残りの要素をすべて無視したいときは、左辺を*のみにする。
  ```ruby
  e, * = 1, 2, 3
  e #=> 1
  # e, *ではなく、e, で終わっても同じ結果になる。
  ```

- 一つの配列を複数の引数やwhen節の条件
  ある配列に別の配列を追加する時、`push`を使うと配列がそのまま配列内に追加される（ネストした配列になる）。
  配列ではなく、中の要素を渡したいときは、配列の前に`*(splat演算子)`を置く。
  ```ruby
  a = [1]
  b = [2, 3]
  a.push(*b) #=> [1, 2, 3]
  ```
  似た考えで、case文のwhen節で`*`を使って配列を複数の条件として展開できる。

- メソッドの可変長引数
  可変長引数とは個数に制限のない引数のこと。自分で定義するメソッドで可変長引数を使いたいときは、引数名の手前に`*`を付ける。
  可変長引数は配列として受け取ることができる。
  可変長引数の`*`は多重代入の`*`の考え方とほとんど同じ。

- `*`で配列同士を非破壊的に連結する
  `[]`の中に*付きで別の配列を置くと、その配列が展開されて別々の要素になる。
  ```ruby
  a = [1, 2, 3]
  [a] #=> [[1, 2, 3]]
  [*a] #=> [1, 2, 3]
  ```
  これを使って、別の配列を要素の一部とする新しい配列を作れる。
