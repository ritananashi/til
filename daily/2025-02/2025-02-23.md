
📖[プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで](https://gihyo.jp/book/2021/978-4-297-12437-3)

#### 正規表現オブジェクトについてもっと詳しく

- 正規表現オブジェクトを作成する様々な方法
  `Regexp.new`の引数にパターンの文字列を渡すことでも正規表現オブジェクトを作れる。
  ```ruby
  Regexp.new('\d{3}-\d{4}')
  # /\d{3}-\d{4}/と同じ
  ```
  `%r`を使うことでも正規表現オブジェクトを作れる（%記法）。
  ```ruby
  %r!https://example\.com!
  # %rを使うときはスラッシュをエスケープしなくて良い
  %r{https://example\.com}
  # !じゃなくて{}を区切り文字にすることもできる
  ```
  `/ /`や`%r`の中で`#{}`を使うと、式の値を埋め込むことができる
  ```ruby
  pattern = '\d{3}-\d{4}'
  '123-4567' =~ /#{pattern}/ #=> 0
  # 式展開されるので、/\d{3}-\d{4}/と書いた時と同じになる。
  ```

- case文で正規表現を使う
  正規表現はcase文のwhen節で使うこともできる。
  case節で指定した文字列が、when節で指定した正規表現にマッチするとwhen節の処理が実行される。
  case文のwhen節で正規表現を使った場合も組込み変数でマッチした結果を参照できる。

- 正規表現オブジェクト作成時のオプション
  正規表現オブジェクトの作成時にはいくつかのオプションを渡すことができる。
  `/正規表現/オプション`のように渡す。
  `i`オプションを渡すと、アルファベットの大文字と小文字の違いを無視してマッチする。
  `Regexp.new`を使う場合は、`Regexp::IGNORECASE`という定数を渡す。
  `m`オプションを使うと、任意の文字を表すドット(`.`)が改行文字にもマッチするようになる。
  `Regexp.new`を使う場合は、`Regexp::MULTILINE`という定数を渡す。
  `x`オプションを使うと、空白文字が無視されて、`#`を使って正規表現中にコメントが書けるようになる。
  `x`オプションをつけている時に空白を無視せずに扱いたい場合は、バックスラッシュでエスケープする。
  `Regexp.new`を使う場合は、`Regexp::EXTENDED`という定数を渡す。
  オプションは同時に扱うこともできる。`Regexp.new`の時は、`|`で連結する。

- `Regexp.last_match`でマッチの結果を取得する
  `Regexp.last_match`メソッドを使うと、組込み変数のように、`=~`演算子等で最後にマッチした結果をMatchDataオブジェクトとして取得できる。
  `Regexp.last_match`を使えば組込み変数を使うよりは可読性が上がるが、matchメソッドで明示的にMatchDataオブジェクトを受け取る方法に比べると暗黙的に値が設定される点がわかりにくいので、多用は避けた方がいい。

- 組込み変数を書き換えない`match?`メソッド
  `match?`メソッドは文字列が正規表現にマッチすればtrue、マッチしなければfalseを返す。
  マッチした場合でも組込み変数や`Regexp.last_match`の内容を書き換えないので、`=~`演算子や`match`メソッドよりも高速。
