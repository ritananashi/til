
📖[プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで](https://gihyo.jp/book/2021/978-4-297-12437-3)

#### クラスの継承（つづき）

- メソッドのオーバーライド  
  サブクラスでスーパークラスと同名のメソッドを定義すると、スーパークラスの処理を上書きできる。  

- クラスメソッドの継承  
  クラスを継承すると、クラスメソッドも継承される。  
  なので、サブクラスでもスーパークラスのクラスメソッドが呼び出せる。  

#### メソッドの可視性

メソッドには、
- public
- protected
- private

という3つの可視性がある。  

- publicメソッド  
  publicメソッドはクラスの外部からでも呼び出せるメソッドのこと。  
  `initialize`以外のインスタンスメソッドはデフォルトでpublic。  

- privateメソッド  
  privateメソッドは外部に公開されないメソッド。  
  クラス外から呼び出せない。クラスの内部からのみ呼び出せる。  
  クラス内でprivateキーワードを書くと、そこから下で定義されたメソッドはprivateメソッドになる。  

- privateメソッドから先に定義する場合  
  publicキーワードの下に定義したメソッドはpublicメソッドになるので、好きな順番でprivateとpublicを定義できる。  
  でもクラスの最後のほうにprivateを定義してまとめることの方が多い。  

- privateメソッドはサブクラスでも呼び出せる。  
  Rubyでは、privateメソッドはサブクラスでも呼び出せる。  
  サブクラスでprivateメソッドをオーバーライドすることもできる。  
  場合によっては意図せずprivateメソッドをオーバーライドしてしまい、思わぬ不具合の原因になることもあるので、継承を使うときはスーパークラスの実装もしっかり把握しておく必要がある。  
  サブクラスでメソッドをオーバーライドすると可視性も変更できてしまうので、ここも気を付ける。  

- クラスメソッドをprivateにしたい場合  
  privateメソッドになるのは基本的にインスタンスメソッドだけになる。  
  クラスメソッドはprivateキーワードの下に定義してもprivateにならない。  
  クラスメソッドをprivateにしたいときは、`class << self`構文を使う。  
  他にも、`private_class_method`でクラスメソッドの定義後に可視性を変更することもできる。  

- メソッドの可視性を返る方法  
  既存のpublicメソッドを`private :メソッド名`のようにprivateキーワードに渡すと、渡したメソッドがprivateメソッドになる。  
  privateキーワードに引数を渡した場合は、その下に定義したメソッドの可視性は変更されない。  
  Rubyのメソッド定義は式になっていて、メソッド定義が完了するとメソッド名をシンボルとして返すので、  
  ```ruby  
  private def foo
    'foo'
  end
  ```
  のように、メソッド定義と同時にprivateメソッドにすることができる。  
  アクセサメソッドをprivateメソッドにしたいときは、privateキーワードにゲッターとセッターのメソッド名を渡す。  
  Ruby3.0からは、`private attr_accessor :メソッド名`のように1行で定義できる。  

- protectedメソッド  
  protectedメソッドはメソッドを定義したクラス自身と、そのサブクラスのインスタンスメソッドからレシーバ付きで呼び出せる。  
  外部には公開したくないが、同じクラスやサブクラスの中であればレシーバ付きで呼び出せるようにしたいときに使う。  
  インスタンス変数の内容を返すだけの単純なゲッターメソッドなら、`attr_reader`を使った方がシンプル。  