
📖プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで

3章、テスト自動化についての章。minitestの基本とプログラムのテスト自動化についてやるよう。

#### minitestの基本

minitestはRubyをインストールするときに一緒にインストールされるテスティングフレームワーク。  
Railsでもデフォルトのテスティングフレームワークになってる。  

- テストコードのひな型
  ```ruby
  require 'minitest/autorun' # minitesutのライブラリ読み込み
  # テストコード本体ここから↓
  class SampleTest < Minitest::Test # < Minitest::Testでテストのクラスを継承
  # 慣習としてTestで終わる名前を付けることが多い。キャメルケースで書く。
    def test_sample # Minitestはtest_で始まる名前のメソッドを探して実行する。 
      assert_equal 'TEST', 'test'.upcase # 'TEST'と'test'.upcaseが等しければパスする。
    end
  end
  # ここまで↑
  ```
  - `assert_equal b, a`  
    bとaが等しければテストをパスする
  - `assert a`  
    aが真だったらテストをパスする
  - `refute a`  
    aが偽だったらテストをパスする
  - `assetr_output`  
    標準出力への出力内容を検証する
  - `assert_raises`  
    指定した例外が発生したときにテストをパスする
- テストコードの実行と結果の確認
  `ruby テストのファイル名`コマンドでテスト実行
  テスト結果には、テストの進捗やテストの実行スピードなどが表示される。
  最後の行にテストの実行結果のまとめが表示される
  - runs　→　実行したテストメソッドの件数
  - assertions　→　実行した懸賞メソッドの件数
  - failures　→　検証に失敗したテストメソッドの件数
  - errors　→　検証中にエラーが発生したテストメソッドの件数
  - skips　→　skipメソッドで実行をスキップしたテストメソッドの件数

  failuresとerrorsの件数が0であれば、テストは全部パスしたことになる。
  テストが失敗すると、進捗にFが表示され、どのテストのどこでどのように失敗したのかという詳細な情報が表示される。
  テスト中にエラーが発生したときは、進捗状況にEが表示され、エラーの詳細説明が表示される。
  テストが失敗したときも、エラーが起きたときも、そのテストメソッドはそれ以上実行されない。複数のテストメソッドがあるなら次のテストの実行に移る。
  テストコードを作成する手間はかかるが、そのあとの動作確認が素早く終われば、トータルで見て早く作業が終わる。
  テストは機械に任せた方がいい。

また、minitest以外にもRSpecやtest-unitというテスティングフレームワークもある。
RSpecは独特の記法を使うが、慣れたら効率よくテストコードが書けるようになる。また、利用者が多いので日本語の情報も豊富。
test-unitはテスティングフレームワークの中では最も歴史が古く、Ruby本体のテストコードもtest-unitで書かれてる。minitestと互換性のあるフレームワークを目指していたので、テストコードが似ている。
test-unitもRubyインストール時に一緒にインストールされる。
  
ハンズオン部分は[ruby_learning](https://github.com/ritananashi/til/tree/main/ruby_learning)フォルダで実施。libとtestフォルダ。
