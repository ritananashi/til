
📖[プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで](https://gihyo.jp/book/2021/978-4-297-12437-3)

#### ブロックについてもっと詳しく（つづき）

- ブロックローカル変数  
  ブロックパラメータを`;`で区切り、続けて変数を宣言すると、ブロック内でのみ有効な独立したローカル変数を宣言することができる。  
  これをブロックローカル変数という。

- 繰り返し処理以外でも使用されるブロック  
  配列やハッシュの繰り返し処理以外でもブロックが使われることがある。  
  例えば、外部リソースを扱うメソッド`File.open`を使うときは、ブロック内にファイルに書き込む内容を記述する。

- do...endと{}の結合度の違い  
  ブロックは`do...end`よりも`{}`のほうが結合度が強い。  
  なので、引数付きのメソッド呼び出しで`{}`をブロックとして使うときは、メソッド引数の`()`を省略したら、構文エラーになる。
  ```ruby
  a = [1, 2, 3]
  # do...endのブロックを渡すと、引数の()を省略しても動く
  a.delete 100 do
    'NG'
  end
  #=> "NG"
  # {}だと`100 { 'NG' }`だと解釈されて、構文エラーになる
  a.delete 100 { 'NG' }
  #=> syntax error
  # ()で囲めばa.delete(100)だと優先的に解釈される
  a.delete(100) {'NG' }
  #=> "NG"
  ```

#### 範囲(Range)についてもっと詳しく

- 終端や始端を持たない範囲オブジェクト  
  `(10..)`や`10..nil`で、終端を持たない範囲オブジェクトを、`(..10)`や`nil..10`などで始端を持たない範囲オブジェクトを定義できる。  
  始端や終端を持たない範囲オブジェクトを使うと、例えば配列の何番目以降の要素を全部取得したり、何番目以前の範囲を全部取得したりできる。  
  両端にnilを指定することで始端も終端もない全範囲を表す範囲オブジェクトを作成できるが、nilを両方とも省略することはできない。

#### さまざまな繰り返し処理

- timesメソッド  
  配列を使わずにn回処理を繰り返したいときは`times`メソッドをつかう。  
- uptoメソッドとdowntoメソッド  
  nからmまで1つずつ増やしながら処理をしたいときは`upto`メソッド、逆に数値を減らしていきたいときは`downto`メソッドをつかう。
- stepメソッド  
  nからmまで数値をx個ずつ増やしながら処理をしたいときは`setup`メソッドを使う。  
  `開始値.step(上限値、一度に増減する大きさ)`
- while文とuntil文  
  `while`文は指定した条件が真である間処理を繰り返す。  
  `until`文は条件が偽である間、処理を繰り返す。繰り返しの条件が逆になる以外は`while`文と同じ。  
  条件式を間違えたり、いつまでも条件式の結果が変わらないようなコードを書いたりすると無限ループするので、無限ループを発生させないようにする。
  ```ruby
  while 条件式
    繰り返したい処理
  end

  # 条件式の後ろにdoを入れると一行で書ける
  while 条件式 do 処理 end
  # 1行で書くなら修飾子としてwhile文を後ろに置いたほうがすっきりする
  処理 while 条件
  # どんな条件でも最低1回は実行したいときはbegin...endで囲んでからwhileを書く。
  begin
    処理
  end while 条件
  ```
