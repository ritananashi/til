
📖[プロを目指す人のためのRuby入門［改訂2版］ 言語仕様からテスト駆動開発・デバッグ技法まで](https://gihyo.jp/book/2021/978-4-297-12437-3)

#### Rubyにおける正規表現オブジェクト（つづき）
- 正規表現と組み合わせると便利なStringクラスのメソッド
  - `scan`  
    引数で渡した正規表現にマッチする部分を配列に入れる。  
    正規表現に()があると、キャプチャされた部分が配列の配列になって返る。  
  - `[]`、`slice`、`slice!`  
    `[]`に正規表現を渡すと、文字列から正規表現にマッチした部分を抜き出す。  
    マッチする部分が複数ある場合は、最初にマッチした文字列が返る。  
    キャプチャを使うと、第二引数で何番目のキャプチャを取得するか指定できる。  
    名前付きキャプチャであれば、名前で指定できる。  
    `slice`は`[]`のエイリアス。`slice!`にすると、マッチした部分が文字列から破壊的に取り除かれる。  
  - `split`  
    `split`に正規表現を渡すと、マッチした文字列を区切り文字にして文字列を分解し、配列として返す。  
  - `gsub`、`gsub!`  
    `gsub`メソッドを使うと、第一引数の正規表現にマッチした文字列を第二引数の文字列で置き換える。  
    第二引数にハッシュを渡す手、変換のルールを指定することもできる。  
    第二引数を渡す代わりに、ブロックの戻り値で書き換える文字列を指定することもできる。  
    `gsub!`は文字列の内容を破壊的に置換する。  
    `gsub`や`gsub!`はキャプチャと組み合わせて文字列を置換することもできる。  
    キャプチャを使う場合は、第二引数に文字列で指定する方法と、ブロックと組込み変数を使う方法の2種類がある。  
    第二引数に文字列で指定する場合は、`\1`や`\2`のようにしてキャプチャ下文字列を連番で参照できる。  
    第二引数に`\1`や`\2`を指定する場合は、文字列を""で囲むか''で囲むかで書き方が変わる。  
    ""で囲むときは、`\1`や`\2`がバックスラッシュ記法の一種だと解釈されてしまう。ので、`\`を二つ重ねてエスケープする必要がある。  
    バックスラッシュをエスケープしようとすると、第二引数に指定する文字列がかなり複雑になる場合がある。  
    `gsub`や`gsub!`で第二引数の代わりにブロックを使って文字列を置換できるので、上記の問題を回避できる。  
    ブロックの内部では、組込み変数でキャプチャ下文字列を参照できる。  
    ブロックの戻り値が置換後の文字列になる。  
    名前付きキャプチャを使う場合も第二引数に文字列で指定する方法とブロックを使う方法の2種類がある。  
    文字列で指定する場合は`\k<name>`のようにすると参照できる。  
    ブロックを使うときは、組込み変数でMatchDataオブジェクトが参照できるので、キャプチャ下文字列は`$~[:name]`のようにして参照できる。  
    公式リファレンスではブロックを使う方法が推奨されている。

