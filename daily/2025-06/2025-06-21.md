※スクール内timesの移植（2025/09/19）

- 学習時間：3h30min/16h/1018h
- 学習内容：卒制

なんだか集中力が死んでるので短めにおわる。  
昨日のつづきやってました。  
結局専用のコントローラ作ることにしました。単一責任の原則。  
中身的には[https://github.com/heartcombo/devise/wiki/How-To:-Allow-users-to-edit-their-password](https://github.com/heartcombo/devise/wiki/How-To:-Allow-users-to-edit-their-password)を参考に実装したものをコピペで写しただけです。  
ついでにアカウント削除のボタンも同じページにのせることにしました。  
アカウント削除のボタンはDeviseのデフォルトだと`<%= button_to "Cancel my account", registration_path(resource_name), data: { confirm: "Are you sure?", turbo_confirm: "Are you sure?" }, method: :delete %>`みたいになっています。  
パスの部分が`registration_path(resource_name)`になっていますが、`user_registration_path`と同じパスになります。  
`registration_path(resource_name)`は[https://github.com/heartcombo/devise/blob/main/lib/devise/controllers/url_helpers.rb](https://github.com/heartcombo/devise/blob/main/lib/devise/controllers/url_helpers.rb)で定義されているもので、
> Create url helpers to be used with resource/scope configuration. Acts as
proxies to the generated routes created by devise.
Resource param can be a string or symbol, a class, or an instance object.
Example using a :user resource:
new_session_path(:user)      => new_user_session_path
session_path(:user)          => user_session_path
destroy_session_path(:user)  => destroy_user_session_path
new_password_path(:user)     => new_user_password_path
password_path(:user)         => user_password_path
edit_password_path(:user)    => edit_user_password_path
new_confirmation_path(:user) => new_user_confirmation_path
confirmation_path(:user)     => user_confirmation_path
Those helpers are included by default to ActionController::Base.
In case you want to add such helpers to another class, you can do
that as long as this new class includes both url_helpers and
mounted_helpers. Example:
include Rails.application.routes.url_helpers
include Rails.application.routes.mounted_helpers
リソース/スコープ設定と組み合わせて使用するURLヘルパーを作成します。これは、
Deviseによって生成されたルーティングの代理として機能します。
リソースパラメーターは、文字列またはシンボル、クラス、またはインスタンスオブジェクトのいずれかです。
:user リソースを使用した例:
new_session_path(:user)      => new_user_session_path
session_path(:user)          => user_session_path
destroy_session_path(:user)  => destroy_user_session_path
new_password_path(:user)     => new_user_password_path
password_path(:user)         => user_password_path
edit_password_path(:user)    => edit_user_password_path
new_confirmation_path(:user) => new_user_confirmation_path
confirmation_path(:user)     => user_confirmation_path
これらのヘルパーはデフォルトでActionController::Baseに組み込まれています。
別のクラスにこのようなヘルパーを追加したい場合は、
その新しいクラスがurl_helpersとmounted_helpersの両方を包含している限り、
追加可能です。例:
include Rails.application.routes.url_helpers
include Rails.application.routes.mounted_helpers

ということらしいです。  
`registration_path(resource_name)`のままだと、Deviseのコントローラ配下のviewじゃないとうまく動かないのですが、`user_registration_path`に直せば他のviewでも問題なく使えます。  

なるはやで直したかったところ直したので、レビューのシステムスペック書きます。明後日。

