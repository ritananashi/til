※スクール内timesの移植（2025/11/18）

出かけたり昨日の実装の続きしたりなどしていた。  
志望動機一発でLGTMでてHAPPYです。やったぜ。  

ロボらんてくんZと相談しながら添付画像枚数をキャッシュするカラム作って、画像枚数数えてカラムに保存するカスタムメソッド作って…としていました。  
投稿の保存時には`adter_commit`コールバックで`update_column`を使って画像を数えてカラムを更新するのがいいそうです。  
編集画面で画像一枚ずつ消せるようにしているので、そこでは`decrement!`を使って減らそうと思ったのですが、（多分ユーザーはやらないと思うけど一応）`画像だけ消して編集するボタンを押さずに一覧画面や詳細ページに戻ったときに、カラムの値が減っているか`を確認してみたところ、`画像枚数が1枚以上あるときは画像の枚数を表示させる`ようにしているのに、`画像枚数が表示されなくなった`ので、明日ちょっとデバックしてどういう挙動になったのか確認しないとな…と思いました。  
そこはそれとして、画像だけ消して`編集する`ボタンを押さずに戻るようなことするユーザーなんているか？とも思うので、`decrement!`いらない気がするなあと思いました（`編集する`を押したら`update`アクションが起動して`after_commit`も発火するので）。  
挙動が気になるので明日確認する…予定…。  

